{% extends 'base.html' %}

{% block content %}
  <div class="container mt-4" style="color: #d1d1d1ff;">
    <a class="icon-link" href="{{ url_for('index') }}">
      <svg xmlns="http://www.w3.org/2000/svg" class="bi" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16" fill="currentColor">
        <path fill-rule="evenodd" d="M15 8a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 0 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 7.5H14.5A.5.5 0 0 1 15 8z" />
      </svg>Back to users
    </a>

    <h1 class="mb-4" style="color: #0088ffff;">Movies for {{ name }}</h1>

    <!-- Add Movie Form -->
    <div class="card mb-4 bg-dark text-white border border-primary">
      <div class="card-body p-3">
        <form method="POST" action="/users/{{ user.id }}/movies" class="d-flex align-items-center gap-2">
          <label for="movie_name" class="mb-0 me-2">Enter movie name:</label>
          <input class="form-control form-control-sm bg-dark text-white border-primary" style="max-width: 300px;" type="text" id="movie_name" name="title" placeholder="Add movie" required />
          <button class="btn btn-outline-primary btn-sm" type="submit">Add movie</button>
        </form>
      </div>
    </div>

    <div class="row row-cols-1 row-cols-md-4 g-4">
      {% for movie in movies %}
        <div class="col">
          <div class="card h-100 text-white border border-primary" style="background-color: #000;">
            <!-- Uniform Poster Image -->
            <img src="{{ movie.poster_url }}" class="card-img-top" alt="Movie Poster" />

            <div class="card-body">
              <!-- Movie Title Update Form -->
              <form method="POST" action="/users/{{ user.id }}/movies/{{ movie.id }}/update" class="d-flex align-items-center gap-2 mb-3">
                <input type="text" class="form-control form-control-sm bg-dark text-white border-primary" name="title" value="{{ movie.name }}" placeholder="Movie title" required />
                <button type="submit" class="btn btn-outline-primary btn-sm">Update</button>
              </form>

              <!-- Movie Info -->
              <p class="mb-1">
                <strong>Director:</strong> {{ movie.director }}
              </p>
              <p class="mb-3">
                <strong>Year:</strong> {{ movie.year }}
              </p>

              <!-- Delete Button -->
              <form action="/users/{{ user.id }}/movies/{{ movie.id }}/delete" method="POST">
                <input type="submit" class="btn btn-outline-danger btn-sm" value="Delete" />
              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
{% endblock %}
